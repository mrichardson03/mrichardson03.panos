---
- import_tasks: 'reset.yml'

- name: test_panos_config_element - Simple Create
  vars:
    banner_text: new banner
  panos_config_element:
    xpath: '/config/devices/entry[@name="localhost.localdomain"]/deviceconfig/system'
    element: '<login-banner>{{ banner_text }}</login-banner>'
  register: result

- name: test_panos_config_element - Assert Simple Create was successful
  assert:
    that:
      - result is success
      - result is changed

- name: test_panos_config_element - Simple Create (idempotence)
  vars:
    banner_text: new banner
  panos_config_element:
    xpath: '/config/devices/entry[@name="localhost.localdomain"]/deviceconfig/system'
    element: '<login-banner>{{ banner_text }}</login-banner>'
  register: result

- name: test_panos_config_element - Assert Simple Create (idempotence) was successful
  assert:
    that:
      - result is success
      - result is not changed

- name: test_panos_config_element - Modify
  vars:
    banner_text: another banner
  panos_config_element:
    xpath: '/config/devices/entry[@name="localhost.localdomain"]/deviceconfig/system'
    element: '<login-banner>{{ banner_text }}</login-banner>'
  register: result

- name: test_panos_config_element - Assert modify was successful
  assert:
    that:
      - result is success
      - result is changed

- name: test_panos_config_element - List Entry Create
  panos_config_element:
    xpath: "/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/address"
    element: |
      <entry name="Test-One">
        <ip-netmask>1.1.1.1</ip-netmask>
      </entry>
  register: result

- name: test_panos_config_element - Assert List Entry Create was successful
  assert:
    that:
      - result is success
      - result is changed

- name: test_panos_config_element - List Entry Create (idempotence)
  panos_config_element:
    xpath: "/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/address"
    element: |
      <entry name="Test-One">
        <ip-netmask>1.1.1.1</ip-netmask>
      </entry>
  register: result

- name: test_panos_config_element - Assert List Entry Create was successful (idempotence)
  assert:
    that:
      - result is success
      - result is not changed

- name: test_panos_config_element - List Entry Additional Create
  panos_config_element:
    xpath: "/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/address"
    element: |
      <entry name="Test-Two">
        <ip-netmask>1.1.1.2</ip-netmask>
      </entry>
  register: result

- name: test_panos_config_element - Assert List Entry Additional Create was successful
  assert:
    that:
      - result is success
      - result is changed

- name: test_panos_config_element - List Entry Additional Create  (idempotence)
  panos_config_element:
    xpath: "/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/address"
    element: |
      <entry name="Test-Two">
        <ip-netmask>1.1.1.2</ip-netmask>
      </entry>
  register: result

- name: test_panos_config_element - Assert List Entry Additional Create was successful (idempotence)
  assert:
    that:
      - result is success
      - result is not changed
